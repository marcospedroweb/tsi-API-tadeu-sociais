(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var o=function(){function t(n){e(this,t),this.tables=n,this.tables.forEach((function(e){window.localStorage.getItem(e)||window.localStorage.setItem(e,JSON.stringify([]))}))}return n(t,[{key:"init",value:function(e){e&&this.tables&&this.tables.forEach((function(e){var t=JSON.parse(window.localStorage.getItem(e));t.length>0&&(t.forEach((function(e,t){e.id=t+1})),window.localStorage.setItem(e,JSON.stringify(t)))}))}}]),t}();const a=new(function(){function t(n,o){e(this,t),this.alert=document.querySelector(n),this.alertSpan=document.querySelector(o),this.alertColors=["alert-danger","alert-success","alert-warning"]}return n(t,[{key:"removeAlertColor",value:function(){var e=this;this.alertColors.forEach((function(t){return e.alert.classList.remove(t)}))}},{key:"init",value:function(e,t){var n=this;this.alert&&e&&t&&(this.removeAlertColor(),this.alert.classList.add("alert-".concat(e)),this.alertSpan.textContent=t,this.alert.classList.toggle("d-none"),setTimeout((function(){n.alert.classList.toggle("show")}),200),setTimeout((function(){n.alert.classList.toggle("show"),setTimeout((function(){n.alert.classList.toggle("d-none")}),400)}),5e3))}}]),t}())("#main-alert","span");var s=function(){function t(n){e(this,t),this.forms=document.querySelectorAll(n)}return n(t,[{key:"init",value:function(){Array.prototype.slice.call(this.forms).forEach((function(e){e.addEventListener("submit",(function(t){e.checkValidity()||(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")}),!1)}))}}]),t}(),r=function(){function t(n,o){e(this,t),this.form=document.querySelector(n),this.table=JSON.parse(localStorage.getItem(o)),this.userLogged=JSON.parse(sessionStorage.getItem("userLogged"))}return n(t,[{key:"init",value:function(){var e=this;this.userLogged&&this.form&&window.location.href.indexOf("login.html")&&(window.location.href="".concat(window.location.origin,"/login.html")),this.form&&this.form.addEventListener("submit",(function(t){t.preventDefault();var n,o=e.form.querySelector("#email").value,s=e.form.querySelector("#password").value;e.table.forEach((function(e){e.email===o&&e.password===s&&(n=e)})),n?(sessionStorage.setItem("userLogged",JSON.stringify(n)),window.location.href="".concat(window.location.origin,"/index.html?success=account-created")):(a.init("danger","Senha e/ou email não correspondem."),e.form.querySelector("#password").value="")}))}}]),t}();function i(){var e=JSON.parse(sessionStorage.getItem("userLogged")),t=document.querySelector("#unregistered-user"),n=document.querySelector("#create-post"),o=document.querySelector("#posts");if(e&&t){var a=document.querySelector("#div-login-register");if(!a.classList.contains("d-none")){a.classList.add("d-none");var s=document.querySelector("#div-user-logged");s.classList.contains("d-none")&&(s.querySelector("#user-name").textContent=e.name,s.classList.remove("d-none"))}t.classList.contains("d-none")||t.classList.toggle("d-none"),n.classList.contains("d-none")&&n.classList.toggle("d-none"),o.classList.contains("d-none")&&o.classList.toggle("d-none")}else if(t){var r=document.querySelector("#div-login-register");if(r.classList.contains("d-none")){r.classList.remove("d-none");var i=document.querySelector("#div-user-logged");i.classList.contains("d-none")||i.classList.add("d-none")}t.classList.contains("d-none")&&t.classList.toggle("d-none"),n.classList.contains("d-none")||n.classList.toggle("d-none"),o.classList.contains("d-none")||o.classList.toggle("d-none")}}var c=function(){function t(n,o){e(this,t),this.form=document.querySelector(n),this.table=JSON.parse(localStorage.getItem(o)),this.userLogged=JSON.parse(sessionStorage.getItem("userLogged"))}return n(t,[{key:"init",value:function(){var e=this;this.userLogged&&this.form&&window.location.href.indexOf("register.html")&&(window.location.href="".concat(window.location.origin,"/register.html")),this.form&&this.form.addEventListener("submit",(function(t){var n,o;t.preventDefault();var s=e.form.querySelector("#name").value,r=e.form.querySelector("#email").value,i=e.form.querySelector("#password").value,c=e.form.querySelector("#confirm-password").value,l=e.form.querySelector("#cpf").value,d=e.form.querySelector("#tel").value;if(e.table.forEach((function(e){e.email===r&&(n=!0),e.cpf===l&&(o=!0)})),0!==r.length&&-1!==r.indexOf("@"))if(n)a("danger","Este email está indisponível, utilize outro");else if(i.toLowerCase()!==i)if(i.length<4)a("danger","A senha deve ter mínimo 4 caracteres");else if(i===c)if(o)a("danger","Este CPF já esta sendo utilizando, tente outro.");else if(l.match(/\d{3}[.-]?\d{3}[.-]?\d{3}-?\d{2}/g))if(d.length>1&&!d.match(/\(?\d{2}\)? ?\d{5}-?\d{4}/g))a("danger","O número de celular deve ser maior que 11 caracteres. Ex: (99) 99999-9999");else{var u={id:0,name:s,email:r,password:i,cpf:l,tel:d||"Não registrado"};e.table.push(u),localStorage.setItem("users",JSON.stringify(e.table)),window.location.href=window.location.href.replace("register.html","login.html?success=account-created")}else a("danger","O CPF deve ser maior que 11 caracteres. Ex: xxx.xxx.xxx-xx");else a("danger","As senhas não são iguais!");else a("danger","A senha deve possuir ao menos 1 letra maiúscula");else a("danger","Insira um email valido. Ex: exemploEmail@email.com")}))}}]),t}();function l(){var e=document.querySelectorAll(".button-delete-post");e[0]&&e.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.getAttribute("id").replace("button-delete-",""),n=JSON.parse(sessionStorage.getItem("userLogged")),s=JSON.parse(window.localStorage.getItem("posts"));s.forEach((function(e,o){e.id==parseInt(t)&&e.userId==n.id&&(s.splice(o,1),a("success","Postagem apagada com sucesso"))})),localStorage.setItem("posts",JSON.stringify(s)),o(),u()}))}))}function d(){var e=document.querySelectorAll(".post-time");e[0]&&e.forEach((function(e){if("false"==e.dataset.formated){var t=function(e){var t=36e5,n=24*t,o=7*n,a=4*o,s=12*a;if((e=(new Date).getTime()-e)<1e3)return"".concat(e," milesimos atrás");if(e<6e4){var r=parseInt(e/1e3);return"".concat(r,1===r?" segundo atrás":" segundos atrás")}if(e<t){var i=parseInt(e/6e4);return"".concat(i,1===i?" minuto atrás":" minutos atrás")}if(e<n){var c=parseInt(e/t);return"".concat(c,1===c?" hora atrás":" horas atrás")}if(e<o){var l=parseInt(e/n);return"".concat(l,1===l?" dia atrás":" dias atrás")}if(e<a){var d=parseInt(e/o);return"".concat(d,1===d?" semana atrás":" semanas atrás")}if(e<s){var u=parseInt(e/a);return"".concat(u,1===u?" mês atrás":" mêses atrás")}var m=parseInt(e/s);return"".concat(m,1===m?" ano atrás":" anos atrás")}(e.textContent);e.textContent=t,e.dataset.formated=!0}}))}function u(){var e=document.querySelector("#posts");if(e){var t=JSON.parse(window.localStorage.getItem("posts")).reverse();e.querySelectorAll(".post").forEach((function(t){e.removeChild(t)})),t.forEach((function(t){var n=function(e){var t=JSON.parse(sessionStorage.getItem("userLogged")),n=document.createElement("article");n.classList.add("post","col-10","col-md-6","d-flex","flex-column","py-4","p-2","rounded");var o=document.createElement("div"),a=document.createElement("i"),s=document.createElement("h3"),r=document.createElement("h3"),i=document.createElement("button");o.classList.add("d-flex","align-items-center","post-header","position-relative"),a.classList.add("bi","bi-person-circle","me-2"),s.classList.add("post-username","mb-0","me-2","h3"),s.textContent=e.username,r.classList.add("post-time"),r.textContent=e.date,r.dataset.formated=!1,t.id==e.userId&&(i.classList.add("button-delete-post","btn","btn-secondary","position-absolute","top-50","end-0","translate-middle-y"),i.setAttribute("id","button-delete-".concat(e.id)),i.setAttribute("type","button"),i.textContent="Apagar postagem"),o.appendChild(a),o.appendChild(s),o.appendChild(r),t.id==e.userId&&o.appendChild(i);var c=document.createElement("div");if(e.text){var l=document.createElement("div"),d=document.createElement("div"),u=document.createElement("p");l.classList.add("bg-post-text","position-relative","p-2","my-2","rounded"),d.classList.add("block-decorator"),u.classList.add("text-start","text-white","m-0"),u.textContent=e.textValue,l.appendChild(d),l.appendChild(u),c.appendChild(l)}if(e.media){var m=document.createElement("div");if(".mp4"==e.mediaType){var g=document.createElement("video");g.classList.add("ratio","ratio-16x9"),g.setAttribute("controls","controls"),g.setAttribute("preload","none"),g.src=e.mediaSrc,m.appendChild(g)}else if("mpeg"==e.mediaType){var f=document.createElement("audio");f.setAttribute("controls","controls"),f.setAttribute("preload","none"),f.src=e.mediaType,m.appendChild(f)}else{var p=document.createElement("img");p.classList.add("img-fluid"),p.src=e.mediaSrc,m.appendChild(p)}c.appendChild(m)}if(e.draw){var v=document.createElement("div"),h=document.createElement("img");v.classList.add("p-2"),h.classList.add("img-fluid"),h.src=e.drawSrc,v.appendChild(h),c.appendChild(v)}if(e.location){var y=document.createElement("div"),L=document.createElement("iframe");L.src=e.locationSrc,L.classList.add("ratio","ratio-1x1"),window.innerWidth<992?L.setAttribute("height",400):L.setAttribute("height",500),y.appendChild(L),c.appendChild(y)}return n.appendChild(o),n.appendChild(c),n}(t);e.appendChild(n)})),l(),d()}}function m(e){if(e){var t=JSON.parse(window.localStorage.getItem("posts"));t.push(e)?(localStorage.setItem("posts",JSON.stringify(t)),a("success","Postagem realizado com sucesso!"),u()):a("danger","Houve um erro ao realizar a postagem, tente novamente")}}var g=function(){function t(n,o,a,s){e(this,t),this.unregisteredUser=document.querySelector(n),this.createPost=document.querySelector(o),this.posts=document.querySelector(a),this.userLogged=JSON.parse(sessionStorage.getItem(s))}return n(t,[{key:"init",value:function(){this.unregisteredUser&&this.userLogged&&(this.unregisteredUser.classList.contains("d-none")||this.unregisteredUser.classList.toggle("d-none"),this.createPost.classList.contains("d-none")&&this.createPost.classList.toggle("d-none"),this.posts.classList.contains("d-none")&&this.posts.classList.toggle("d-none"))}}]),t}();function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var p,v,h,y,L,S,w,b,q=function(){function t(n){e(this,t),this.tooltipTriggerList=document.querySelectorAll(n)}return n(t,[{key:"init",value:function(){var e;this.tooltipTriggerList[0]&&(e=this.tooltipTriggerList,function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e){return new bootstrap.Tooltip(e)}))}}]),t}();new o(["users","posts"]).init(!0),function(){for(var e=window.location.search.substr(1).split("&"),t={},n=0;n<e.length;n++){var o=e[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}t.success&&"account-created"===t.success&&(a.init("success","Conta criada com sucesso!"),window.location.href=window.location.href.replace("?success=account-created",""))}(),new s(".needs-validation").init(),new g("#unregistered-user","#create-post","#posts","userLogged").init(),new q('[data-bs-toggle="tooltip"]').init(),new c("#form-register","users").init(),new r("#form-login").init(),i(),(p=document.querySelector("#link-logout"))&&p.addEventListener("click",(function(e){e.preventDefault(),JSON.parse(sessionStorage.getItem("userLogged"))&&(sessionStorage.removeItem("userLogged"),i(),a("success","Saiu da sessão com sucesso"))})),(v=document.querySelector("#cpf"))&&(v.addEventListener("input",(function(e){"insertFromPaste"==e.inputType&&(v.value="")})),v.addEventListener("keypress",(function(e){[3,7].includes(v.value.length)&&"."!=e.key?v.value+=".":11==v.value.length&&"-"!=e.key?v.value+="-":(v.value.length>10&&v.value.match(/\d{3}\.?\d{3}\.?\d{3}-?\d{2}/g)||isNaN(e.key)&&"."!=e.key&&"-"!=e.key)&&e.preventDefault()}))),(h=document.querySelector("#tel"))&&(h.addEventListener("input",(function(e){"insertFromPaste"==e.inputType&&(h.value="")})),h.addEventListener("keypress",(function(e){0==h.value.length&&"("!==e.key?h.value+="(":3==h.value.length&&")"!==e.key?h.value+=") ":4==h.value.length&&" "!==e.key?h.value+=" ":10==h.value.length&&"-"!==e.key?h.value+="-":(h.value.length>0&&h.value.match(/\(?\d{2}\)?\ ?\d{5}\-?\d{4}/g)||isNaN(e.key)&&"-"!==e.key&&"("!==e.key&&")"!==e.key)&&e.preventDefault()}))),function(){var e=document.querySelector("#btn-add-location"),t=document.querySelector("#data-location"),n=document.querySelector("#span-location");if(e)if("geolocation"in navigator){var o=function(o){var a=o.coords.latitude,s=o.coords.longitude;t.value="https://embed.waze.com/pt-BR/iframe?zoom=12&lat=".concat(a,"&lon=").concat(s,"&pin=1"),e.classList.contains("disabled")||e.classList.toggle("disabled"),n.classList.contains("d-none")&&n.classList.toggle("d-none"),setTimeout((function(){n.classList.contains("show")||n.classList.toggle("show")}),250)},s=function(e){a("danger","Houve um erro! Não é possivel adicionar a localização atual, tente novamente.")},r={enableHighAccuracy:!0,maximumAge:3e4,timeout:3e4};e.addEventListener("click",(function(e){navigator.geolocation.getCurrentPosition(o,s,r)}))}else a("danger","Ops, seu navegador não suporta geolocation")}(),function(){var e=document.querySelector("#drawingBoard");if(e){var t=function(){f=i.value,p=c.value,v=l.value},n=function(t){if(t.preventDefault(),"false"!==r.drawing){var n=function(e,t){var n,o;t.preventDefault();var a=e.getBoundingClientRect();return t.changedTouches?(n=t.changedTouches[0].clientX-a.left,o=t.changedTouches[0].clientY-a.top):(n=t.clientX-a.left,o=t.clientY-a.top),{x:n,y:o}}(e,t);s.lineWidth=f,s.lineCap=p,s.strokeStyle=v,s.lineTo(n.x,n.y),s.stroke(),s.beginPath(),s.moveTo(n.x,n.y)}},o=document.querySelector("#btn-add-draw"),s=e.getContext("2d"),r=e.dataset,i=document.querySelector("#option-line-width"),c=document.querySelector("#option-line-cap"),l=document.querySelector("#option-line-color"),d=document.querySelector("#clear-drawing"),u=document.querySelector("#save-draw"),m=document.querySelector("#span-draw"),g=document.querySelector("#data-draw"),f=i.value,p=c.value,v=l.value;i.addEventListener("input",(function(e){i.value.length&&0!=i.value||(i.value=5),t()})),c.addEventListener("change",(function(e){e.preventDefault(),t()})),l.addEventListener("change",(function(e){e.preventDefault(),t()})),e.addEventListener("mousedown",(function(e){e.preventDefault(),r.drawing=!0,n(e)})),e.addEventListener("touchstart",(function(e){e.preventDefault(),r.drawing=!0,n(e)})),e.addEventListener("mouseup",(function(e){e.preventDefault(),r.drawing=!1,s.beginPath()})),e.addEventListener("touchend",(function(e){e.preventDefault(),r.drawing=!1,s.beginPath()})),e.addEventListener("mousemove",n),e.addEventListener("touchmove",n),o.addEventListener("click",(function(){window.innerWidth>992&&(e.width=600,e.height=600)})),o.addEventListener("touchstart",(function(){window.innerWidth<992&&(e.width=300,e.height=300)})),d.addEventListener("click",(function(t){t.preventDefault(),s.clearRect(0,0,e.width,e.height)})),u.addEventListener("click",(function(){var t=e.toDataURL("image/png",1);t.length>5e5?a("danger","O tamanho do arquivo é maior que 500KB, tente novamente"):(g.value=t,o.classList.contains("disabled")||o.classList.toggle("disabled"),m.classList.contains("d-none")&&m.classList.toggle("d-none"),setTimeout((function(){m.classList.contains("show")||m.classList.toggle("show")}),250))}))}}(),m(),u(),d(),y=document.querySelector("#post-content-text"),L=document.querySelector("#char-counter span"),y&&y.addEventListener("input",(function(e){var t=e.target.value;L.textContent=t.length})),S=document.querySelectorAll(".post-content"),(w=document.querySelectorAll(".btn-cancel-content"))[0]&&w.forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.getAttribute("id").replace("cancel-",""),n=document.querySelector("#btn-add-".concat(t));document.querySelector("#data-".concat(t)).value="",n.classList.contains("disabled")&&n.classList.toggle("disabled"),S.forEach((function(e){e.getAttribute("id").replace("span-","")==t&&(e.classList.contains("show")&&e.classList.toggle("show"),setTimeout((function(){e.classList.contains("d-none")||e.classList.toggle("d-none")}),250))}))}))})),function(){var e=document.querySelector("#btn-add-media"),t=document.querySelector("#midia-file"),n=document.querySelector("#span-media"),o=document.querySelector("#media-type"),s=document.querySelector("#data-media");t&&t.addEventListener("change",(function(r){var i=r.target.files[0],c=".".concat(i.type.replace("video/","").replace("image/","").replace("mpeg/","")),l=new FileReader;l.onload=function(r){i.size<=5e5&&[".mpeg",".mp4",".png",".jpg",".jpeg"].includes(c)?(s.value=r.target.result,o.textContent=c,n.classList.contains("d-none")&&n.classList.toggle("d-none"),e.classList.contains("disabled")||e.classList.toggle("disabled"),setTimeout((function(){n.classList.contains("show")||n.classList.toggle("show")}),250)):(t.value="",a("danger","O tamanho do arquivo deve ter no maximo 500KB e deve ser do tipo (.mp3, .mp4, .png ou .jpg)"))},l.readAsDataURL(r.target.files[0])}))}(),(b=document.querySelector("#btn-tadeuzar"))&&b.addEventListener("click",(function(){var e,t,n,o,s,r,i=JSON.parse(sessionStorage.getItem("userLogged")),c=JSON.parse(window.localStorage.getItem("posts")),l=document.querySelector("#post-content-text"),d=document.querySelector("#data-media"),u=document.querySelector("#media-type"),g=document.querySelector("#data-draw"),f=document.querySelector("#data-location"),p={id:c.length,userId:i.id,username:i.name,date:(new Date).getTime()};0!=l.value.trim().length||0!=d.value.length||0!=g.value.length||0!=f.value.length?(0!=l.value.trim()&&(p.text=!0,p.textValue=l.value),d.value&&(p.media=!0,p.mediaType=u.textContent,p.mediaSrc=d.value),g.value&&(p.draw=!0,p.drawSrc=g.value),f.value&&(p.location=!0,p.locationSrc=f.value),m(p),e=document.querySelector("#btn-add-location"),t=document.querySelector("#span-location"),n=document.querySelector("#btn-add-draw"),o=document.querySelector("#span-draw"),s=document.querySelector("#btn-add-media"),r=document.querySelector("#span-media"),l.value="",d.value="",u.textContent="",g.value="",f.value="",e.classList.contains("disabled")&&e.classList.toggle("disabled"),t.classList.contains("show")&&t.classList.toggle("show"),n.classList.contains("disabled")&&n.classList.toggle("disabled"),o.classList.contains("show")&&o.classList.toggle("show"),s.classList.contains("disabled")&&s.classList.toggle("disabled"),r.classList.contains("show")&&r.classList.toggle("show"),setTimeout((function(){t.classList.contains("d-none")||t.classList.toggle("d-none"),o.classList.contains("d-none")||o.classList.toggle("d-none"),r.classList.contains("d-none")||r.classList.toggle("d-none")}),250)):a("danger","Para realizar o post é necessário adicionar algum conteudo")})),l()})();